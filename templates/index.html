{% extends "base.html" %}

{% block head %}
  <link rel="canonical" href="{{ section.permalink | safe }}">
  <meta property="og:type" content="website">
  <meta property="og:title" content="{{ section.title | default(value=config.title) }}">
  <meta property="og:description" content="{{ section.description | default(value=config.description) }}">
  <meta property="og:url" content="{{ section.permalink | safe }}">
  <meta name="twitter:card" content="summary">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": {% if section.title %}{{ section.title | json_encode }}{% else %}{{ config.title | json_encode }}{% endif %},
    "url": {{ section.permalink | json_encode }},
    "description": {% if section.description %}{{ section.description | json_encode }}{% else %}{{ config.description | json_encode }}{% endif %}
  }
  </script>
{% endblock head %}

{% block content %}
  {{ section.content | safe }}

  <h2>Latest posts</h2>
  {% set blog = get_section(path="blog/_index.md") %}
  {% if blog and blog.pages and blog.pages | length > 0 %}
    <ul>
      {% for page in blog.pages | slice(end=5) %}
        <li>
          <a href="{{ page.permalink }}">{{ page.title }}</a>
          {% if page.date %}<span class="muted">— {{ page.date | date(format="%Y-%m-%d") }}</span>{% endif %}
        </li>
      {% endfor %}
    </ul>
    <p><a href="{{ get_url(path='blog') }}">All posts →</a></p>
  {% else %}
    <p class="muted">No posts yet. When you publish to <code>content/blog/</code> they’ll appear here.</p>
  {% endif %}

  {% set cats = get_taxonomy(kind="categories") %}
  {% if cats and cats.items and cats.items | length > 0 %}
    <h3>Browse by category</h3>
    <p>
      {% for term in cats.items %}
        <a href="{{ term.permalink }}">{{ term.name }}</a>{% if not loop.last %} · {% endif %}
      {% endfor %}
    </p>
  {% endif %}
{% endblock content %}